<!-- DESKTOP-PERFORMANCE PATCH (MOBILE UNCHANGED) -->

<!-- 1) Ensure viewport meta is present -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- 2) Desktop-only hero enhancements -->
<style media="(min-width: 992px)">
  .banner-inner {
    background-image: image-set(
      url('/amazon-super-search-lightning-deals-banner.jpg') 1x,
      url('/amazon-super-search-lightning-deals-banner@2x.jpg') 2x
    );
    background-size: cover;
    background-position: center;
  }
  body { font-family: 'Inter', sans-serif; }
  @keyframes pulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.05)} }
  @keyframes glow  { 0%{text-shadow:0 0 8px rgba(255,255,255,0.6),0 0 16px rgba(255,255,255,0.4)} 100%{text-shadow:0 0 16px rgba(255,255,255,1),0 0 32px rgba(255,255,255,0.7)} }
  .banner-inner .site-title {
    animation: pulse 3s ease-in-out infinite, glow 2.5s ease-in-out infinite alternate;
    font-size: clamp(1.5rem,5vw,3rem);
    color: #FF9900;
  }
  /* Translate widget overrides */
  .goog-te-menu2 { max-height:300px!important; overflow-y:auto!important; }
  .goog-te-menu2 table { width:100%!important; }
  .goog-te-menu-frame.skiptranslate,
  .skiptranslate .goog-te-menu2 { max-height:300px!important; height:auto!important; overflow-y:auto!important; }
  .goog-te-banner-frame.skiptranslate { display:none!important; }
  body { top:0!important; }
</style>

<!-- 3) Scope CSS preloads to desktop -->
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css"
      as="style" onload="this.onload=null;this.rel='stylesheet'" media="(min-width:992px)">
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      as="style" onload="this.onload=null;this.rel='stylesheet'" media="(min-width:992px)">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css"
      as="style" onload="this.onload=null;this.rel='stylesheet'" media="(min-width:992px)">

<!-- 4) Lazy-load images only on desktop -->
<script>
  if (window.innerWidth >= 992) {
    document.querySelectorAll('img').forEach(img => {
      if (!img.hasAttribute('loading')) img.setAttribute('loading', 'lazy');
    });
  }
</script>

<!-- 5) Defer and dedupe scripts on desktop -->
<script>
  if (window.innerWidth >= 992) {
    // Remove duplicates if present
    document.querySelectorAll('script[src*="tagify.min.js"]').forEach((s, i) => i>0 && s.remove());
    document.querySelectorAll('script[src*="translate_a/element.js"]').forEach((s, i) => i>0 && s.remove());
    // Defer load
    ['https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.min.js',
     'https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit'
    ].forEach(src => {
      const s = document.createElement('script');
      s.src = src;
      s.defer = true;
      document.head.appendChild(s);
    });
  }
</script>
